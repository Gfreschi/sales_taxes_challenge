%%{init: {
  "theme": "base",
  "flowchart": { "curve": "basis", "htmlLabels": true, "padding": 16, "wrap": true },
  "themeVariables": {
    "fontFamily": "Inter, Segoe UI, Roboto, Arial, sans-serif",
    "primaryTextColor": "#0b1220",
    "nodeTextColor": "#0b1220",
    "lineColor": "#64748b",
    "edgeLabelBackground": "#ffffff",
    "graphPadding": 16,
    "nodeSpacing": 28,
    "rankSpacing": 48,
    "fontSize": "14px"
  }
}}%%
flowchart LR
  subgraph S1["Input & Parse"]
    direction LR
    A[📄 Input] --> B[📝 Parser]
  end

  subgraph S2["Classification"]
    direction LR
    B --> C{🔍 Classify}
  end

  subgraph S3["Tax Rules"]
    direction LR
    C --> D[❌ Exempt<br/>0%]
    C --> E[💰 Basic<br/>10%]
    C --> F[🚢 Import<br/>+5%]
  end

  subgraph S4["Calculation & Rounding"]
    direction LR
    D --> G[🧮 Calculate]
    E --> G
    F --> G
    G --> H[🔄 Round<br/>↑$0.05]
  end

  subgraph S5["Output"]
    direction LR
    H --> I[🧾 Receipt]
  end

  classDef input fill:#e3f2fd,stroke:#1976d2,stroke-width:3px,rx:10,ry:10
  classDef process fill:#f1f8e9,stroke:#689f38,stroke-width:2px,rx:10,ry:10
  classDef decision fill:#fff3e0,stroke:#f57c00,stroke-width:2px,rx:10,ry:10
  classDef tax fill:#fce4ec,stroke:#c2185b,stroke-width:2px,rx:10,ry:10
  classDef output fill:#f3e5f5,stroke:#7b1fa2,stroke-width:3px,rx:10,ry:10

  linkStyle default stroke:#64748b,stroke-width:1.6

  class A input
  class B,G,H process
  class C decision
  class D,E,F tax
  class I output
